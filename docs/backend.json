{
  "entities": {
    "Family": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Family",
      "type": "object",
      "description": "Represents a family account within the Ascend Wealth application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Family entity."
        },
        "familyName": {
          "type": "string",
          "description": "The name of the family, typically the head's last name."
        },
        "familyHeadName": {
          "type": "string",
          "description": "The full name of the family head."
        },
        "phoneNumber": {
          "type": "string",
          "description": "The phone number of the family."
        },
        "emailId": {
          "type": "string",
          "description": "The email address of the family.",
          "format": "email"
        },
        "dateOfBirth": {
          "type": "string",
          "description": "The date of birth of the family head.",
          "format": "date-time"
        },
        "address": {
          "type": "string",
          "description": "The address of the family."
        },
        "anniversaryDate": {
          "type": "string",
          "description": "The anniversary date of the family (optional).",
          "format": "date-time"
        },
        "panPhotoUrl": {
          "type": "string",
          "description": "URL of the PAN photo document."
        },
        "aadhaarPhotoUrl": {
          "type": "string",
          "description": "URL of the Aadhaar photo document."
        },
        "otherDocumentUrl": {
          "type": "string",
          "description": "URL of the other document."
        }
      },
      "required": [
        "id",
        "familyName",
        "familyHeadName",
        "phoneNumber",
        "emailId",
        "dateOfBirth",
        "address"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/families/{familyId}",
        "definition": {
          "entityName": "Family",
          "schema": {
            "$ref": "#/backend/entities/Family"
          },
          "description": "Stores family data. Includes information such as family head name, contact details, and document URLs.",
          "params": [
            {
              "name": "familyId",
              "description": "Unique identifier for the family document."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore structure is designed to manage customer (family) data within the Ascend Wealth application, adhering to strict role-based access control (RBAC) and the principle of Authorization Independence. It leverages path-based ownership for user-owned data and denormalization to avoid `get()` calls in security rules, ensuring atomic operations and simplified rule management.\n\nThe core entities are stored under the `/families` collection. This collection stores all the details of a customer family (Family Head, Name, Contact Details, Addresses and URLs for uploaded documents).\n\nThis design achieves Authorization Independence by storing all data related to a family in a single document within the `families` collection, eliminating the need for hierarchical `get()` calls in security rules. It supports the required QAPs by ensuring secure `list` operations through role-based access control defined in security rules (e.g., only Associates and higher roles can list families, and Associates can only list families assigned to them). Segregation of data based on role is achieved structurally, preventing unauthorized access to sensitive information. Additionally, storing the `familyId` on assets will also provide authorization independence for the assets as they exist within their own collection, and do not need to make 'get()' calls to family documents to confirm ownership.\n\nThis design promotes clarity, security, scalability, and debuggability while adhering to the principles outlined in the prompt."
  }
}